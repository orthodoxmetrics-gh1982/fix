{
  "id": "55df67b70181",
  "originalPath": "/var/www/orthodox-church-mgmt/orthodoxmetrics/prod/server/debug-session-config.js",
  "relativePath": "server/debug-session-config.js",
  "name": "debug-session-config.js",
  "extension": ".js",
  "size": 1558,
  "modified": "2025-07-22T08:51:31.186Z",
  "created": "2025-07-22T08:51:29.625Z",
  "classification": {
    "type": "Troubleshooting Utilities",
    "category": "Diagnostic Tools",
    "confidence": 3
  },
  "metadata": {
    "fileStats": {
      "lines": 41,
      "characters": 1548,
      "words": 145
    },
    "classification": {
      "type": "Troubleshooting Utilities",
      "category": "Diagnostic Tools",
      "confidence": 3
    },
    "dependencies": [
      {
        "type": "npm_package",
        "name": "dotenv",
        "line": 7
      }
    ],
    "security": {
      "findings": [
        {
          "type": "sensitive_data",
          "pattern": "(?:secret|token)\\s*[:=]\\s*['\"]([^'\"]+)['\"]",
          "line": 15,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 9,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 10,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 10,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 13,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 14,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 15,
          "redacted": true
        }
      ],
      "hasSecurityIssues": true,
      "redactedContent": "#!/usr/bin/env node\r\n\r\nconsole.log('üîç DEBUG: Session Configuration Values');\r\nconsole.log('=====================================');\r\n\r\n// Load environment variables\r\nrequire('dotenv').config();\r\n\r\nconst isProduction = process.env.[REDACTED] === 'production';\r\nconst isHTTPS = process.env.[REDACTED] === 'true' || process.env.[REDACTED] === 'production';\r\n\r\nconsole.log('Environment Variables:');\r\nconsole.log('  NODE_ENV:', process.env.[REDACTED]);\r\nconsole.log('  HTTPS:', process.env.[REDACTED]);\r\nconsole.log('  SESSION_SECRET:'[REDACTED]'SET' : 'NOT SET');\r\n\r\nconsole.log('\\nCalculated Values:');\r\nconsole.log('  isProduction:', isProduction);\r\nconsole.log('  isHTTPS:', isHTTPS);\r\n\r\nconsole.log('\\nCookie Configuration:');\r\nconsole.log('  secure:', isHTTPS);\r\nconsole.log('  httpOnly: true');\r\nconsole.log('  domain:', isProduction ? '.orthodoxmetrics.com' : undefined);\r\n\r\nconsole.log('\\nüéØ Expected vs Current:');\r\nconsole.log('  We WANT secure: true for HTTPS');\r\nconsole.log('  We HAVE secure:', isHTTPS);\r\n\r\nif (!isHTTPS) {\r\n    console.log('\\n‚ùå PROBLEM FOUND:');\r\n    console.log('  isHTTPS is false, so secure cookies are disabled!');\r\n    console.log('  This is why browser cookies show Secure: false');\r\n    \r\n    console.log('\\nüîß SOLUTION:');\r\n    console.log('  The environment variables are not being set properly');\r\n    console.log('  PM2 might not be picking up HTTPS=true');\r\n} else {\r\n    console.log('\\n‚úÖ Configuration looks correct');\r\n    console.log('  The issue might be browser cache or session persistence');\r\n} "
    },
    "complexity": {
      "totalLines": 41,
      "codeLines": 30,
      "commentLines": 2,
      "commentRatio": 0.0625,
      "averageLineLength": 46.71875
    },
    "lastAnalyzed": "2025-07-28T07:20:00.256Z"
  },
  "contentHash": "ec1e2b6d4bcee3840f6b43f53033b45acf07efb665c22eda10688825327a9b46",
  "discoveredAt": "2025-07-28T07:20:00.256Z"
}