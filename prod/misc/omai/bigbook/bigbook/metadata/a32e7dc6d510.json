{
  "id": "a32e7dc6d510",
  "originalPath": "/var/www/orthodox-church-mgmt/orthodoxmetrics/prod/run-calendar-schema-dynamic.sh",
  "relativePath": "run-calendar-schema-dynamic.sh",
  "name": "run-calendar-schema-dynamic.sh",
  "extension": ".sh",
  "size": 2390,
  "modified": "2025-07-23T21:16:10.013Z",
  "created": "2025-07-23T21:16:06.523Z",
  "classification": {
    "type": "Database Scripts",
    "category": "Backend > Database",
    "confidence": 2
  },
  "metadata": {
    "fileStats": {
      "lines": 89,
      "characters": 2388,
      "words": 287
    },
    "classification": {
      "type": "Database Scripts",
      "category": "Backend > Database",
      "confidence": 2
    },
    "dependencies": [],
    "security": {
      "findings": [
        {
          "type": "sensitive_data",
          "pattern": "(?:password|pwd|pass)\\s*[:=]\\s*['\"]([^'\"]+)['\"]",
          "line": 41,
          "redacted": true
        }
      ],
      "hasSecurityIssues": true,
      "redactedContent": "#!/bin/bash\n\n# OrthodoxMetrics Calendar System Database Schema - Dynamic Username\necho \"ðŸ”§ Running OrthodoxMetrics Calendar Database Schema (Dynamic Username)...\"\n\n# Colors for output\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m' # No Color\n\nprint_status() {\n    echo -e \"${BLUE}[INFO]${NC} $1\"\n}\n\nprint_success() {\n    echo -e \"${GREEN}[SUCCESS]${NC} $1\"\n}\n\nprint_error() {\n    echo -e \"${RED}[ERROR]${NC} $1\"\n}\n\nprint_warning() {\n    echo -e \"${YELLOW}[WARNING]${NC} $1\"\n}\n\n# Check if schema file exists\nif [ ! -f \"server/calendar-schema.sql\" ]; then\n    print_error \"Calendar schema file not found: server/calendar-schema.sql\"\n    exit 1\nfi\n\nprint_status \"Calendar schema file found. Creating database schema...\"\n\n# Get database credentials\nread -p \"Enter MySQL username (default: orthodoxapps): \" DB_USER\nDB_USER=${DB_USER:-orthodoxapps}\n\nread -s -p \"Enter MySQL password: \"[REDACTED]\"\"\n\nread -p \"Enter MySQL host (default: localhost): \" DB_HOST\nDB_HOST=${DB_HOST:-localhost}\n\nread -p \"Enter database name (default: orthodoxmetrics_db): \" DB_NAME\nDB_NAME=${DB_NAME:-orthodoxmetrics_db}\n\nprint_status \"Creating calendar database schema with dynamic username...\"\n\n# Create a temporary file with the correct username\nTEMP_SCHEMA=\"/tmp/calendar_schema_dynamic.sql\"\n\n# Copy the schema and replace the username\ncp server/calendar-schema.sql \"$TEMP_SCHEMA\"\n\n# Replace the username in GRANT statements\nsed -i \"s/'orthodoxapps'@'%'/'${DB_USER}'@'%'/g\" \"$TEMP_SCHEMA\"\n\n# Run the schema\nmysql -u \"$DB_USER\" -p\"$DB_PASS\" -h \"$DB_HOST\" < \"$TEMP_SCHEMA\"\n\nif [ $? -eq 0 ]; then\n    print_success \"Database schema created successfully!\"\n    \n    # Verify the tables were created\n    print_status \"Verifying tables...\"\n    mysql -u \"$DB_USER\" -p\"$DB_PASS\" -h \"$DB_HOST\" \"$DB_NAME\" -e \"\n    SHOW TABLES LIKE 'ai_%';\n    SHOW TABLES LIKE 'task_%';\n    SHOW TABLES LIKE 'kanban_%';\n    SHOW TABLES LIKE 'calendar_%';\n    SHOW TABLES LIKE 'chatgpt_%';\n    \" 2>/dev/null\n    \n    # Clean up temp file\n    rm -f \"$TEMP_SCHEMA\"\n    \n    print_success \"Calendar database schema setup completed!\"\n    echo \"\"\n    echo \"Next steps:\"\n    echo \"1. Run the full setup: ./setup-calendar-system.sh\"\n    echo \"2. Or start the system: ./start-calendar-system.sh (if it exists)\"\nelse\n    print_error \"Failed to create database schema\"\n    rm -f \"$TEMP_SCHEMA\"\n    exit 1\nfi "
    },
    "complexity": {
      "totalLines": 89,
      "codeLines": 57,
      "commentLines": 11,
      "commentRatio": 0.16176470588235295,
      "averageLineLength": 33.64705882352941
    },
    "lastAnalyzed": "2025-07-26T04:17:10.290Z"
  },
  "contentHash": "94410c7cf96a8dbab19f388ea47aec6f2cea76169f751ec07db99aaeabe90208",
  "discoveredAt": "2025-07-26T04:17:10.290Z"
}