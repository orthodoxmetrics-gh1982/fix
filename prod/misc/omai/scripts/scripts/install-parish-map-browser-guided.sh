#!/bin/bash

# ğŸ—ºï¸ Browser-Guided ParishMap Installation
# ========================================
# Since you're already logged in as superadmin, this guides you through browser installation

echo "ğŸ—ºï¸ ParishMap Component - Browser Installation Guide"
echo "=================================================="
echo "[$(date '+%Y-%m-%d %H:%M:%S')] Browser-guided installation..."

# Check if ParishMap.tsx exists
if [ ! -f "ParishMap.tsx" ]; then
    echo "âŒ ERROR: ParishMap.tsx not found in current directory"
    echo "ğŸ’¡ Current directory: $(pwd)"
    exit 1
fi

echo "âœ… Found ParishMap.tsx ($(wc -c < ParishMap.tsx) bytes)"
echo ""

echo "ğŸ¯ Since you're already logged in as superadmin, let's use the browser method:"
echo ""
echo "ğŸ“‹ STEP-BY-STEP BROWSER INSTALLATION:"
echo "====================================="
echo ""
echo "1. ğŸŒ You're already in the admin interface - perfect!"
echo "   Current page: Admin Settings"
echo ""
echo "2. ğŸ“ Navigate to Big Book:"
echo "   â€¢ Look for 'OM Big Book' or 'Big Book' in the left sidebar"
echo "   â€¢ Click on it to open the Big Book interface"
echo ""
echo "3. ğŸ§© Go to Custom Components tab:"
echo "   â€¢ Once in Big Book, look for tabs at the top"
echo "   â€¢ Click on the 'Custom Components' tab"
echo ""
echo "4. ğŸ“¤ Upload ParishMap.tsx:"
echo "   â€¢ You'll see an upload area with drag & drop functionality"
echo "   â€¢ Either:"
echo "     - Drag ParishMap.tsx from your file manager to the upload area"
echo "     - OR click the upload area and select ParishMap.tsx"
echo ""
echo "5. ğŸš€ Use Big Book Auto-Install Mode:"
echo "   â€¢ The TSX Component Installation Wizard will open automatically"
echo "   â€¢ IMPORTANT: Toggle ON the 'Big Book Auto-Install Mode' switch"
echo "   â€¢ This will:"
echo "     âœ… Set target directory to: src/components/bigbook/custom"
echo "     âœ… Enable registry integration"
echo "     âœ… Generate route: /bigbook/parish-map"
echo "     âœ… Add menu item to Big Book sidebar"
echo ""
echo "6. âœ… Install:"
echo "   â€¢ Click 'Install Component' button"
echo "   â€¢ Wait for the installation to complete"
echo "   â€¢ You should see success messages in the console"
echo ""
echo "7. ğŸ‰ Verify Installation:"
echo "   â€¢ Look for 'Parish Map' in the Big Book sidebar menu"
echo "   â€¢ You can access it at: /bigbook/parish-map"
echo ""

echo "ğŸ’¡ QUICK NAVIGATION HELP:"
echo "========================"
echo ""
echo "If you can't find 'Big Book' in the sidebar:"
echo "â€¢ Look for 'OM Big Book', 'Big Book', or a book icon ğŸ“š"
echo "â€¢ It might be under 'System Administration' or 'Settings'"
echo "â€¢ Try searching for 'big book' in the page"
echo ""
echo "If the upload area doesn't appear:"
echo "â€¢ Make sure you're on the first tab 'Imports & Scripts'"
echo "â€¢ Look for a drag-and-drop area with cloud upload icon"
echo "â€¢ The area should say 'Drop files here or click to upload'"
echo ""

echo "ğŸ”§ EXPECTED RESULTS AFTER INSTALLATION:"
echo "======================================="
echo ""
echo "âœ… Component installed at: src/components/bigbook/custom/ParishMap.tsx"
echo "âœ… Route created: https://orthodoxmetrics.com/bigbook/parish-map"
echo "âœ… Menu item: 'Parish Map' in Big Book sidebar"
echo "âœ… Registry updated: bigbook-custom-components.json"
echo ""

echo "ğŸ“‹ COMPONENT FEATURES YOU'LL GET:"
echo "================================="
echo ""
echo "ğŸ—ºï¸ Interactive Orthodox Parish Map with:"
echo "â€¢ Leaflet-based mapping with marker clustering"
echo "â€¢ Parish filtering by jurisdiction, state, diocese, city"
echo "â€¢ Mock parish data for demonstration"
echo "â€¢ Responsive design for mobile and desktop"
echo "â€¢ Popup details for each parish"
echo "â€¢ Custom Orthodox church icons"
echo ""

echo "ğŸš¨ TROUBLESHOOTING:"
echo "==================="
echo ""
echo "If 'Install Component' button is greyed out:"
echo "â€¢ Check browser console (F12) for any errors"
echo "â€¢ Make sure the file uploaded correctly"
echo "â€¢ Try refreshing the page and uploading again"
echo ""
echo "If installation fails:"
echo "â€¢ Check the Big Book console output for error messages"
echo "â€¢ Make sure you toggled ON 'Big Book Auto-Install Mode'"
echo "â€¢ Verify you're on the 'Custom Components' tab"
echo ""
echo "If component doesn't appear in sidebar:"
echo "â€¢ Refresh the page after installation"
echo "â€¢ Check the 'Custom Components' tab to see if it's listed"
echo "â€¢ Try accessing directly: /bigbook/parish-map"
echo ""

echo "[$(date '+%Y-%m-%d %H:%M:%S')] Guide complete!"
echo ""
echo "ğŸ¯ Ready to install! Follow the steps above in your browser."
echo ""
echo "ğŸ’¬ The browser method works best since you're already authenticated!"
echo "   Command line installation requires session cookies that aren't available from shell." 