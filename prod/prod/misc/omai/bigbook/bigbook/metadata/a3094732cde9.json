{
  "id": "a3094732cde9",
  "originalPath": "/var/www/orthodox-church-mgmt/orthodoxmetrics/prod/server/config/old.session.js",
  "relativePath": "server/config/old.session.js",
  "name": "old.session.js",
  "extension": ".js",
  "size": 1528,
  "modified": "2025-07-24T14:50:26.304Z",
  "created": "2025-07-24T14:50:26.304Z",
  "classification": {
    "type": "Server Scripts",
    "category": "Backend > Server",
    "confidence": 4
  },
  "metadata": {
    "fileStats": {
      "lines": 44,
      "characters": 1526,
      "words": 148
    },
    "classification": {
      "type": "Server Scripts",
      "category": "Backend > Server",
      "confidence": 4
    },
    "dependencies": [
      {
        "type": "npm_package",
        "name": "express-session",
        "line": 2
      },
      {
        "type": "npm_package",
        "name": "express-mysql-session",
        "line": 3
      },
      {
        "type": "npm_package",
        "name": "path",
        "line": 5
      },
      {
        "type": "npm_package",
        "name": "dotenv",
        "line": 10
      }
    ],
    "security": {
      "findings": [
        {
          "type": "sensitive_data",
          "pattern": "(?:secret|token)\\s*[:=]\\s*['\"]([^'\"]+)['\"]",
          "line": 27,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 7,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 14,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 15,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 16,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 17,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 18,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 27,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 28,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 32,
          "redacted": true
        },
        {
          "type": "sensitive_data",
          "pattern": "process\\.env\\.([A-Z_]+)",
          "line": 33,
          "redacted": true
        }
      ],
      "hasSecurityIssues": true,
      "redactedContent": "// server/config/session.js\r\nconst session = require('express-session');\r\nconst MySQLStore = require('express-mysql-session')(session);\r\n\r\nconst path = require('path');\r\n// pick the correct .env\r\nconst envFile = process.env.[REDACTED] === 'production'\r\n  ? '../.env.production'\r\n  : '../.env.development';\r\nrequire('dotenv').config({ path: path.resolve(__dirname, envFile) });\r\n\r\n// DB connection options\r\nconst dbOptions = {\r\n  host: process.env.[REDACTED] || '0.0.0.0',\r\n  port: process.env.[REDACTED] || 3306,\r\n  user: process.env.[REDACTED] || 'orthodoxapps',\r\n  password: process.env.[REDACTED] || 'Summerof1982@!',\r\n  database: process.env.[REDACTED] || 'orthodoxmetrics_db',\r\n  connectTimeout: 10000, // 10 seconds\r\n  waitForConnections: true,\r\n  connectionLimit: 10\r\n};\r\n\r\nconst store = new MySQLStore(dbOptions);\r\n\r\nconsole.log('ðŸ”§ Session configuration:');\r\nconsole.log('   SESSION_SECRET:'[REDACTED]'***set***' : 'MISSING');\r\nconsole.log('   NODE_ENV:', process.env.[REDACTED]);\r\nconsole.log('   Store configured:', !!store);\r\n\r\nmodule.exports = session({\r\n  key: process.env.[REDACTED] || 'ssppoc.sid',\r\n  secret: process.env.[REDACTED] || 'fallback-secret-key-for-development',\r\n  store,\r\n  resave: false,\r\n  saveUninitialized: false,\r\n  rolling: true,\r\n  cookie: {\r\n    secure: true,        // Required for HTTPS/SSL\r\n    httpOnly: true,      // Security best practice\r\n    maxAge: 1000 * 60 * 60 * 24,      // 1 day\r\n    sameSite: 'none',    // Required for cross-origin requests over HTTPS\r\n  }\r\n});"
    },
    "complexity": {
      "totalLines": 44,
      "codeLines": 36,
      "commentLines": 3,
      "commentRatio": 0.07692307692307693,
      "averageLineLength": 37.8974358974359
    },
    "lastAnalyzed": "2025-07-28T07:19:59.540Z"
  },
  "contentHash": "0d58c1bf8a6a03ad3aff640ce3fc5c9360d620cba8cf367973800f16c43e5531",
  "discoveredAt": "2025-07-28T07:19:59.540Z"
}